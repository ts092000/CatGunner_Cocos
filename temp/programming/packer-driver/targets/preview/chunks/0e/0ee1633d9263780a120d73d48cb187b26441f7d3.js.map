{"version":3,"sources":["file:///Users/ADMIN/Desktop/CatGunner_Github/CatGunner_Cocos/assets/Scripts/Game/PlayerController.ts"],"names":["_decorator","Component","Node","Animation","AnimationClip","input","Input","KeyCode","Vec3","RigidBody2D","Vec2","Camera","sys","ccclass","property","PlayerController","type","currentPLayerHp","isPlayerDead","isDash","isCanPressDash","dame","isMoving","isPlayAnimIdle","isPlayAnimMove","isStop","moveArr1","moveArr2","AnimPlayerArr","animPlayerArr","start","onKeyboard","playIdleMove","update","dt","cameraFollow","playAnimDead","rigidPlayer","linearVelocity","x","y","playAnimMove","length","isMobile","console","log","onKeyDown","event","index","keyCode","KEY_W","findIndex","item","push","ARROW_UP","KEY_A","ARROW_LEFT","KEY_S","ARROW_DOWN","KEY_D","ARROW_RIGHT","KEY_F","playAnimDash","SPACE","playAnimShooting","onKeyUp","index5","splice","index6","index1","index2","index7","index8","index3","index4","offKeyboard","off","EventType","KEY_DOWN","KEY_UP","on","animPlayer","defaultClip","clips","play","node","scale","scheduleOnce","circleNode","position","z","pointNode","targetPos","getPosition","cameraPos","cameraPlayer","Math","abs","redWall","newPos","lerp","setPosition","active"],"mappings":";;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,a,OAAAA,a;AAA8BC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,O,OAAAA,O;AAASC,MAAAA,I,OAAAA,I;AAAaC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,G,OAAAA,G;;;;;;;;;OACxI;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBd,U;;kCAGjBe,gB,WADZF,OAAO,CAAC,kBAAD,C,UAEHC,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAE,CAACZ,aAAD;AAAR,OAAD,C,UAGRU,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAEb;AAAR,OAAD,C,UAGRW,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAEP;AAAR,OAAD,C,UAGRK,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAEd;AAAR,OAAD,C,UAGRY,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAEd;AAAR,OAAD,C,UAGRY,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAEd;AAAR,OAAD,C,UAGRY,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAEL;AAAR,OAAD,C,2BApBb,MACaI,gBADb,SACsCd,SADtC,CACgD;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eAsBrCgB,eAtBqC;AAAA,eAuBrCC,YAvBqC,GAuBb,KAvBa;AAAA,eAwBrCC,MAxBqC,GAwBnB,KAxBmB;AAAA,eAyBrCC,cAzBqC,GAyBX,IAzBW;AAAA,eA2BrCC,IA3BqC,GA2BtB,CA3BsB;AAAA,eA4BrCC,QA5BqC;AAAA,eA6BrCC,cA7BqC,GA6BX,IA7BW;AAAA,eA8BrCC,cA9BqC,GA8BX,IA9BW;AAAA,eAgCrCC,MAhCqC,GAgCnB,KAhCmB;AAAA,eAkCrCC,QAlCqC,GAkChB,EAlCgB;AAAA,eAmCrCC,QAnCqC,GAmChB,EAnCgB;AAAA;;AAqCpB,YAAbC,aAAa,GAAoB;AACxC,iBAAO,KAAKC,aAAZ;AACH;;AAEuB,YAAbD,aAAa,CAACC,aAAD,EAAiC;AACrD,eAAKA,aAAL,GAAqBA,aAArB;AACH;;AAESC,QAAAA,KAAK,GAAS;AACpB,eAAKC,UAAL;AACA,eAAKC,YAAL;AACH;;AAESC,QAAAA,MAAM,CAACC,EAAD,EAAmB;AAC/B,eAAKC,YAAL;AACA,eAAKC,YAAL;;AACA,cAAK,KAAKC,WAAL,CAAiBC,cAAjB,CAAgCC,CAAhC,IAAqC,CAArC,IAA0C,KAAKf,cAAhD,IAAoE,KAAKa,WAAL,CAAiBC,cAAjB,CAAgCE,CAAhC,IAAqC,CAArC,IAA0C,KAAKhB,cAAhD,IAAmE,CAAC,KAAKL,MAAhJ,EAAwJ;AACpJ,iBAAKG,QAAL,GAAgB,IAAhB;AACA,iBAAKE,cAAL,GAAsB,KAAtB;AACA,iBAAKiB,YAAL;AACH,WAJD,MAKK,IAAI,KAAKJ,WAAL,CAAiBC,cAAjB,CAAgCC,CAAhC,KAAsC,CAAtC,IAA2C,KAAKF,WAAL,CAAiBC,cAAjB,CAAgCE,CAAhC,KAAsC,CAAjF,IAAsF,KAAKjB,cAA3F,IAA6G,CAAC,KAAKJ,MAAvH,EAA+H;AAChI,iBAAKI,cAAL,GAAsB,KAAtB;AACA,iBAAKD,QAAL,GAAgB,KAAhB;AACA,iBAAKE,cAAL,GAAsB,IAAtB;AACA,iBAAKQ,YAAL;AACH;;AAED,cAAI,KAAKN,QAAL,CAAc,KAAKA,QAAL,CAAcgB,MAAd,GAAuB,CAArC,MAA4C,CAA5C,IAAiD,CAAC,KAAKvB,MAAvD,IAAiE,CAAC,KAAKM,MAA3E,EAAmF;AAC/E,iBAAKY,WAAL,CAAiBC,cAAjB,GAAkC,IAAI5B,IAAJ,CAAS,CAAC,GAAV,EAAe,KAAK2B,WAAL,CAAiBC,cAAjB,CAAgCE,CAA/C,CAAlC;AACH;;AAED,cAAI,KAAKd,QAAL,CAAc,KAAKA,QAAL,CAAcgB,MAAd,GAAuB,CAArC,MAA4C,CAA5C,IAAiD,CAAC,KAAKvB,MAAvD,IAAiE,CAAC,KAAKM,MAA3E,EAAmF;AAC/E,iBAAKY,WAAL,CAAiBC,cAAjB,GAAkC,IAAI5B,IAAJ,CAAS,GAAT,EAAc,KAAK2B,WAAL,CAAiBC,cAAjB,CAAgCE,CAA9C,CAAlC;AACH;;AAED,cAAI,KAAKb,QAAL,CAAc,KAAKA,QAAL,CAAce,MAAd,GAAuB,CAArC,MAA4C,CAA5C,IAAiD,CAAC,KAAKvB,MAAvD,IAAiE,CAAC,KAAKM,MAA3E,EAAmF;AAC/E,iBAAKY,WAAL,CAAiBC,cAAjB,GAAkC,IAAI5B,IAAJ,CAAS,KAAK2B,WAAL,CAAiBC,cAAjB,CAAgCC,CAAzC,EAA4C,GAA5C,CAAlC;AACH;;AACD,cAAI,KAAKZ,QAAL,CAAc,KAAKA,QAAL,CAAce,MAAd,GAAuB,CAArC,MAA4C,CAA5C,IAAiD,CAAC,KAAKvB,MAAvD,IAAiE,CAAC,KAAKM,MAA3E,EAAmF;AAC/E,iBAAKY,WAAL,CAAiBC,cAAjB,GAAkC,IAAI5B,IAAJ,CAAS,KAAK2B,WAAL,CAAiBC,cAAjB,CAAgCC,CAAzC,EAA4C,CAAC,GAA7C,CAAlC;AACH;;AAED,cAAI,KAAKb,QAAL,CAAcgB,MAAd,KAAyB,CAAzB,IAA8B,KAAKf,QAAL,CAAce,MAAd,KAAyB,CAAvD,IAA4D9B,GAAG,CAAC+B,QAAhE,IAA4E,KAAKxB,MAArF,EAA6F;AACzFyB,YAAAA,OAAO,CAACC,GAAR,CAAY,GAAZ;AACA,iBAAKR,WAAL,CAAiBC,cAAjB,GAAkC,IAAI5B,IAAJ,CAAS,CAAT,EAAY,CAAZ,CAAlC;AACH;AACJ;;AAEMoC,QAAAA,SAAS,CAACC,KAAD,EAA8B;AAC1C,cAAIC,KAAK,GAAG,CAAZ;;AACA,kBAAQD,KAAK,CAACE,OAAd;AACI,iBAAK1C,OAAO,CAAC2C,KAAb;AACIF,cAAAA,KAAK,GAAG,KAAKrB,QAAL,CAAcwB,SAAd,CAAyBC,IAAD,IAAUA,IAAI,KAAK,CAA3C,CAAR;AACA,kBAAIJ,KAAK,KAAK,CAAC,CAAf,EAAkB,KAAKrB,QAAL,CAAc0B,IAAd,CAAmB,CAAnB;AAClB;;AACJ,iBAAK9C,OAAO,CAAC+C,QAAb;AACIN,cAAAA,KAAK,GAAG,KAAKrB,QAAL,CAAcwB,SAAd,CAAyBC,IAAD,IAAUA,IAAI,KAAK,CAA3C,CAAR;AACA,kBAAIJ,KAAK,KAAK,CAAC,CAAf,EAAkB,KAAKrB,QAAL,CAAc0B,IAAd,CAAmB,CAAnB;AAClB;;AACJ,iBAAK9C,OAAO,CAACgD,KAAb;AACIP,cAAAA,KAAK,GAAG,KAAKtB,QAAL,CAAcyB,SAAd,CAAyBC,IAAD,IAAUA,IAAI,KAAK,CAA3C,CAAR;AACA,kBAAIJ,KAAK,KAAK,CAAC,CAAf,EAAkB,KAAKtB,QAAL,CAAc2B,IAAd,CAAmB,CAAnB;AAClB;;AACJ,iBAAK9C,OAAO,CAACiD,UAAb;AACIR,cAAAA,KAAK,GAAG,KAAKtB,QAAL,CAAcyB,SAAd,CAAyBC,IAAD,IAAUA,IAAI,KAAK,CAA3C,CAAR;AACA,kBAAIJ,KAAK,KAAK,CAAC,CAAf,EAAkB,KAAKtB,QAAL,CAAc2B,IAAd,CAAmB,CAAnB;AAClB;;AACJ,iBAAK9C,OAAO,CAACkD,KAAb;AACIT,cAAAA,KAAK,GAAG,KAAKrB,QAAL,CAAcwB,SAAd,CAAyBC,IAAD,IAAUA,IAAI,KAAK,CAA3C,CAAR;AACA,kBAAIJ,KAAK,KAAK,CAAC,CAAf,EAAkB,KAAKrB,QAAL,CAAc0B,IAAd,CAAmB,CAAnB;AAClB;;AACJ,iBAAK9C,OAAO,CAACmD,UAAb;AACIV,cAAAA,KAAK,GAAG,KAAKrB,QAAL,CAAcwB,SAAd,CAAyBC,IAAD,IAAUA,IAAI,KAAK,CAA3C,CAAR;AACA,kBAAIJ,KAAK,KAAK,CAAC,CAAf,EAAkB,KAAKrB,QAAL,CAAc0B,IAAd,CAAmB,CAAnB;AAClB;;AACJ,iBAAK9C,OAAO,CAACoD,KAAb;AACIX,cAAAA,KAAK,GAAG,KAAKtB,QAAL,CAAcyB,SAAd,CAAyBC,IAAD,IAAUA,IAAI,KAAK,CAA3C,CAAR;AACA,kBAAIJ,KAAK,KAAK,CAAC,CAAf,EAAkB,KAAKtB,QAAL,CAAc2B,IAAd,CAAmB,CAAnB;AAClB;;AACJ,iBAAK9C,OAAO,CAACqD,WAAb;AACIZ,cAAAA,KAAK,GAAG,KAAKtB,QAAL,CAAcyB,SAAd,CAAyBC,IAAD,IAAUA,IAAI,KAAK,CAA3C,CAAR;AACA,kBAAIJ,KAAK,KAAK,CAAC,CAAf,EAAkB,KAAKtB,QAAL,CAAc2B,IAAd,CAAmB,CAAnB;AAClB;;AACJ,iBAAK9C,OAAO,CAACsD,KAAb;AACI,mBAAKC,YAAL;AACA;;AACJ,iBAAKvD,OAAO,CAACwD,KAAb;AACI,mBAAKC,gBAAL;AACA;;AACJ;AAAS;AAvCb;AAyCH;;AAEMC,QAAAA,OAAO,CAAClB,KAAD,EAA8B;AACxC,kBAAQA,KAAK,CAACE,OAAd;AACI,iBAAK1C,OAAO,CAAC2C,KAAb;AACI,mBAAKb,WAAL,CAAiBC,cAAjB,GAAkC,IAAI5B,IAAJ,CAAS,KAAK2B,WAAL,CAAiBC,cAAjB,CAAgCC,CAAzC,EAA4C,CAA5C,CAAlC;AACA,kBAAI2B,MAAM,GAAG,KAAKvC,QAAL,CAAcwB,SAAd,CAAyBC,IAAD,IAAUA,IAAI,KAAK,CAA3C,CAAb;AACA,mBAAKzB,QAAL,CAAcwC,MAAd,CAAqBD,MAArB,EAA6B,CAA7B;AACA;;AACJ,iBAAK3D,OAAO,CAAC+C,QAAb;AACI,mBAAKjB,WAAL,CAAiBC,cAAjB,GAAkC,IAAI5B,IAAJ,CAAS,KAAK2B,WAAL,CAAiBC,cAAjB,CAAgCC,CAAzC,EAA4C,CAA5C,CAAlC;AACA,kBAAI6B,MAAM,GAAG,KAAKzC,QAAL,CAAcwB,SAAd,CAAyBC,IAAD,IAAUA,IAAI,KAAK,CAA3C,CAAb;AACA,mBAAKzB,QAAL,CAAcwC,MAAd,CAAqBC,MAArB,EAA6B,CAA7B;AACA;;AACJ,iBAAK7D,OAAO,CAACgD,KAAb;AACI,mBAAKlB,WAAL,CAAiBC,cAAjB,GAAkC,IAAI5B,IAAJ,CAAS,CAAT,EAAY,KAAK2B,WAAL,CAAiBC,cAAjB,CAAgCE,CAA5C,CAAlC;AACA,kBAAI6B,MAAM,GAAG,KAAK3C,QAAL,CAAcyB,SAAd,CAAyBC,IAAD,IAAUA,IAAI,KAAK,CAA3C,CAAb;AACA,mBAAK1B,QAAL,CAAcyC,MAAd,CAAqBE,MAArB,EAA6B,CAA7B;AACA;;AACJ,iBAAK9D,OAAO,CAACiD,UAAb;AACI,mBAAKnB,WAAL,CAAiBC,cAAjB,GAAkC,IAAI5B,IAAJ,CAAS,CAAT,EAAY,KAAK2B,WAAL,CAAiBC,cAAjB,CAAgCE,CAA5C,CAAlC;AACA,kBAAI8B,MAAM,GAAG,KAAK5C,QAAL,CAAcyB,SAAd,CAAyBC,IAAD,IAAUA,IAAI,KAAK,CAA3C,CAAb;AACA,mBAAK1B,QAAL,CAAcyC,MAAd,CAAqBG,MAArB,EAA6B,CAA7B;AACA;;AACJ,iBAAK/D,OAAO,CAACkD,KAAb;AACI,mBAAKpB,WAAL,CAAiBC,cAAjB,GAAkC,IAAI5B,IAAJ,CAAS,KAAK2B,WAAL,CAAiBC,cAAjB,CAAgCC,CAAzC,EAA4C,CAA5C,CAAlC;AACA,kBAAIgC,MAAM,GAAG,KAAK5C,QAAL,CAAcwB,SAAd,CAAyBC,IAAD,IAAUA,IAAI,KAAK,CAA3C,CAAb;AACA,mBAAKzB,QAAL,CAAcwC,MAAd,CAAqBI,MAArB,EAA6B,CAA7B;AACA;;AACJ,iBAAKhE,OAAO,CAACmD,UAAb;AACI,mBAAKrB,WAAL,CAAiBC,cAAjB,GAAkC,IAAI5B,IAAJ,CAAS,KAAK2B,WAAL,CAAiBC,cAAjB,CAAgCC,CAAzC,EAA4C,CAA5C,CAAlC;AACA,kBAAIiC,MAAM,GAAG,KAAK7C,QAAL,CAAcwB,SAAd,CAAyBC,IAAD,IAAUA,IAAI,KAAK,CAA3C,CAAb;AACA,mBAAKzB,QAAL,CAAcwC,MAAd,CAAqBK,MAArB,EAA6B,CAA7B;AACA;;AACJ,iBAAKjE,OAAO,CAACoD,KAAb;AACI,mBAAKtB,WAAL,CAAiBC,cAAjB,GAAkC,IAAI5B,IAAJ,CAAS,CAAT,EAAY,KAAK2B,WAAL,CAAiBC,cAAjB,CAAgCE,CAA5C,CAAlC;AACA,kBAAIiC,MAAM,GAAG,KAAK/C,QAAL,CAAcyB,SAAd,CAAyBC,IAAD,IAAUA,IAAI,KAAK,CAA3C,CAAb;AACA,mBAAK1B,QAAL,CAAcyC,MAAd,CAAqBM,MAArB,EAA6B,CAA7B;AACA;;AACJ,iBAAKlE,OAAO,CAACqD,WAAb;AACI,mBAAKvB,WAAL,CAAiBC,cAAjB,GAAkC,IAAI5B,IAAJ,CAAS,CAAT,EAAY,KAAK2B,WAAL,CAAiBC,cAAjB,CAAgCE,CAA5C,CAAlC;AACA,kBAAIkC,MAAM,GAAG,KAAKhD,QAAL,CAAcyB,SAAd,CAAyBC,IAAD,IAAUA,IAAI,KAAK,CAA3C,CAAb;AACA,mBAAK1B,QAAL,CAAcyC,MAAd,CAAqBO,MAArB,EAA6B,CAA7B;AACA;;AACJ,iBAAKnE,OAAO,CAACwD,KAAb;AACI,mBAAKxC,cAAL,GAAsB,IAAtB;AACA;;AACJ;AACI;AA7CR;AA+CH;;AAEMoD,QAAAA,WAAW,GAAS;AACvBtE,UAAAA,KAAK,CAACuE,GAAN,CAAUtE,KAAK,CAACuE,SAAN,CAAgBC,QAA1B,EAAoC,KAAKhC,SAAzC,EAAoD,IAApD;AACAzC,UAAAA,KAAK,CAACuE,GAAN,CAAUtE,KAAK,CAACuE,SAAN,CAAgBE,MAA1B,EAAkC,KAAKd,OAAvC,EAAgD,IAAhD;AACH;;AAEMlC,QAAAA,UAAU,GAAS;AACtB1B,UAAAA,KAAK,CAAC2E,EAAN,CAAS1E,KAAK,CAACuE,SAAN,CAAgBC,QAAzB,EAAmC,KAAKhC,SAAxC,EAAmD,IAAnD;AACAzC,UAAAA,KAAK,CAAC2E,EAAN,CAAS1E,KAAK,CAACuE,SAAN,CAAgBE,MAAzB,EAAiC,KAAKd,OAAtC,EAA+C,IAA/C;AACH;;AAEMD,QAAAA,gBAAgB,GAAS;AAC5B,cAAI,CAAC,KAAK1C,QAAV,EAAoB;AAChB,iBAAK2D,UAAL,CAAgBC,WAAhB,GAA8B,KAAKD,UAAL,CAAgBE,KAAhB,CAAsB,CAAtB,CAA9B;AACA,iBAAKF,UAAL,CAAgBG,IAAhB;AACH;AACJ;;AAEO3C,QAAAA,YAAY,GAAS;AACzB,eAAKlB,cAAL,GAAsB,IAAtB;AACA,eAAK0D,UAAL,CAAgBC,WAAhB,GAA8B,KAAKD,UAAL,CAAgBE,KAAhB,CAAsB,CAAtB,CAA9B;AACA,eAAKF,UAAL,CAAgBG,IAAhB;AACH;;AAEMpD,QAAAA,YAAY,GAAS;AACxB,eAAKiD,UAAL,CAAgBC,WAAhB,GAA8B,KAAKD,UAAL,CAAgBE,KAAhB,CAAsB,CAAtB,CAA9B;AACA,eAAKF,UAAL,CAAgBG,IAAhB;AACH;;AAEMtB,QAAAA,YAAY,GAAS;AACxB,cAAI,KAAK1C,cAAT,EAAyB;AACrB,iBAAKA,cAAL,GAAsB,KAAtB;AACA,iBAAKG,cAAL,GAAsB,KAAtB;AACA,iBAAKC,cAAL,GAAsB,KAAtB;AACA,iBAAKL,MAAL,GAAc,IAAd;;AACA,gBAAI,KAAKA,MAAT,EAAiB;AACb,kBAAI,KAAKkB,WAAL,CAAiBC,cAAjB,CAAgCC,CAAhC,GAAoC,CAAxC,EAA2C;AACvC,qBAAKF,WAAL,CAAiBC,cAAjB,GAAkC,IAAI5B,IAAJ,CAAS,EAAT,EAAa,KAAK2B,WAAL,CAAiBC,cAAjB,CAAgCE,CAA7C,CAAlC;AACH,eAFD,MAGK,IAAI,KAAKH,WAAL,CAAiBC,cAAjB,CAAgCC,CAAhC,GAAoC,CAAxC,EAA2C;AAC5C,qBAAKF,WAAL,CAAiBC,cAAjB,GAAkC,IAAI5B,IAAJ,CAAS,CAAC,EAAV,EAAc,KAAK2B,WAAL,CAAiBC,cAAjB,CAAgCE,CAA9C,CAAlC;AACH,eAFI,MAEE,IAAI,KAAKH,WAAL,CAAiBC,cAAjB,CAAgCC,CAAhC,KAAsC,CAA1C,EAA6C;AAChD,oBAAI,KAAK8C,IAAL,CAAUC,KAAV,CAAgB/C,CAAhB,KAAsB,CAA1B,EAA6B;AACzB,uBAAKF,WAAL,CAAiBC,cAAjB,GAAkC,IAAI5B,IAAJ,CAAS,EAAT,EAAa,KAAK2B,WAAL,CAAiBC,cAAjB,CAAgCE,CAA7C,CAAlC;AACH,iBAFD,MAEO;AACH,uBAAKH,WAAL,CAAiBC,cAAjB,GAAkC,IAAI5B,IAAJ,CAAS,CAAC,EAAV,EAAc,KAAK2B,WAAL,CAAiBC,cAAjB,CAAgCE,CAA9C,CAAlC;AACH;AACJ;;AACD,mBAAKyC,UAAL,CAAgBC,WAAhB,GAA8B,KAAKD,UAAL,CAAgBE,KAAhB,CAAsB,CAAtB,CAA9B;AACA,mBAAKF,UAAL,CAAgBG,IAAhB;AACA/E,cAAAA,KAAK,CAACuE,GAAN,CAAUtE,KAAK,CAACuE,SAAN,CAAgBC,QAA1B,EAAoC,KAAKhC,SAAzC,EAAoD,IAApD,EAfa,CAgBb;;AACA,mBAAKyC,YAAL,CAAkB,YAAY;AAC1B,qBAAKlD,WAAL,CAAiBC,cAAjB,GAAkC,IAAI5B,IAAJ,CAAS,CAAT,EAAY,KAAK2B,WAAL,CAAiBC,cAAjB,CAAgCE,CAA5C,CAAlC;AACA,qBAAKR,YAAL;AACA3B,gBAAAA,KAAK,CAAC2E,EAAN,CAAS1E,KAAK,CAACuE,SAAN,CAAgBC,QAAzB,EAAmC,KAAKhC,SAAxC,EAAmD,IAAnD;AACA,qBAAKvB,cAAL,GAAsB,IAAtB;AACA,qBAAKC,cAAL,GAAsB,IAAtB;AACA,qBAAKL,MAAL,GAAc,KAAd,CAN0B,CAO1B;AACH,eARD,EAQG,GARH;AASA,mBAAKoE,YAAL,CAAkB,YAAU;AACxB,qBAAKnE,cAAL,GAAsB,IAAtB;AACH,eAFD,EAEG,KAFH;AAGH;AAEJ;AACJ;;AAEOe,QAAAA,YAAY,GAAS;AACzB,eAAKqD,UAAL,CAAgBC,QAAhB,GAA2B,IAAIjF,IAAJ,CAAS,KAAK6E,IAAL,CAAUI,QAAV,CAAmBlD,CAAnB,GAAuB,CAAhC,EAAmC,KAAK8C,IAAL,CAAUI,QAAV,CAAmBjD,CAAnB,GAAuB,EAA1D,EAA8D,KAAKgD,UAAL,CAAgBC,QAAhB,CAAyBC,CAAvF,CAA3B;AACA,eAAKC,SAAL,CAAeF,QAAf,GAA0B,IAAIjF,IAAJ,CAAS,KAAK6E,IAAL,CAAUI,QAAV,CAAmBlD,CAAnB,GAAuB,CAAhC,EAAmC,KAAK8C,IAAL,CAAUI,QAAV,CAAmBjD,CAAnB,GAAuB,EAA1D,EAA8D,KAAKgD,UAAL,CAAgBC,QAAhB,CAAyBC,CAAvF,CAA1B;AACA,cAAIE,SAAS,GAAG,KAAKP,IAAL,CAAUQ,WAAV,EAAhB;AACA,cAAIC,SAAS,GAAG,KAAKC,YAAL,CAAkBV,IAAlB,CAAuBQ,WAAvB,EAAhB;;AACA,cAAKD,SAAS,CAACrD,CAAV,GAAc,CAAC,GAAf,IAAsByD,IAAI,CAACC,GAAL,CAAS,KAAKZ,IAAL,CAAUI,QAAV,CAAmBlD,CAAnB,GAAuB,KAAK2D,OAAL,CAAaT,QAAb,CAAsBlD,CAAtD,KAA4D,GAAnF,IAA2FqD,SAAS,CAACrD,CAAV,IAAe,IAA9G,EAAoH;AAChH,gBAAI4D,MAAM,GAAGL,SAAS,CAACM,IAAV,CAAeR,SAAf,EAA0B,GAA1B,CAAb;AACA,iBAAKG,YAAL,CAAkBV,IAAlB,CAAuBgB,WAAvB,CAAmCF,MAAM,CAAC5D,CAA1C,EAA6C,KAAKwD,YAAL,CAAkBV,IAAlB,CAAuBI,QAAvB,CAAgCjD,CAA7E,EAAgF,IAAhF;AACH;;AACD,cAAIoD,SAAS,CAACpD,CAAV,GAAc,GAAd,IAAqBoD,SAAS,CAACpD,CAAV,GAAc,CAAC,GAAxC,EAA6C;AACzC,gBAAI2D,OAAM,GAAGL,SAAS,CAACM,IAAV,CAAeR,SAAf,EAA0B,GAA1B,CAAb;;AACA,iBAAKG,YAAL,CAAkBV,IAAlB,CAAuBgB,WAAvB,CAAmC,KAAKN,YAAL,CAAkBV,IAAlB,CAAuBI,QAAvB,CAAgClD,CAAnE,EAAsE4D,OAAM,CAAC3D,CAA7E,EAAgF,IAAhF;AACH;AACJ;;AAEOJ,QAAAA,YAAY,GAAS;AACzB,cAAI,KAAKnB,eAAL,IAAwB,CAAxB,IAA6B,KAAKC,YAAL,KAAsB,KAAvD,EAA8D;AAC1D,iBAAKA,YAAL,GAAoB,IAApB;AACAb,YAAAA,KAAK,CAACuE,GAAN,CAAUtE,KAAK,CAACuE,SAAN,CAAgBC,QAA1B,EAAoC,KAAKhC,SAAzC,EAAoD,IAApD;AACAzC,YAAAA,KAAK,CAACuE,GAAN,CAAUtE,KAAK,CAACuE,SAAN,CAAgBE,MAA1B,EAAkC,KAAKd,OAAvC,EAAgD,IAAhD;AACA,iBAAKgB,UAAL,CAAgBC,WAAhB,GAA8B,KAAKD,UAAL,CAAgBE,KAAhB,CAAsB,CAAtB,CAA9B;AACA,iBAAKF,UAAL,CAAgBG,IAAhB;AACA,iBAAKG,YAAL,CAAkB,YAAY;AAC1B,mBAAKI,SAAL,CAAeW,MAAf,GAAwB,KAAxB;AACA,mBAAKd,UAAL,CAAgBc,MAAhB,GAAyB,KAAzB;AACA,mBAAKjB,IAAL,CAAUiB,MAAV,GAAmB,KAAnB;AACH,aAJD,EAIG,CAJH;AAKH;AACJ;;AArR2C,O;;;;;iBAEH,E","sourcesContent":["import { _decorator, Component, Node, Animation, AnimationClip, EventKeyboard, input, Input, KeyCode, Vec3, tween, RigidBody2D, Vec2, Camera, sys } from 'cc';\nconst { ccclass, property } = _decorator;\n\n@ccclass('PlayerController')\nexport class PlayerController extends Component {\n    @property({ type: [AnimationClip] })\n    private animPlayerArr: AnimationClip[] = [];\n\n    @property({ type: Animation })\n    private animPlayer: Animation;\n\n    @property({ type: RigidBody2D })\n    private rigidPlayer: RigidBody2D;\n\n    @property({ type: Node })\n    private circleNode: Node;\n\n    @property({ type: Node })\n    private pointNode: Node;\n\n    @property({ type: Node })\n    private redWall: Node;\n\n    @property({ type: Camera })\n    public cameraPlayer: Camera;\n\n    public currentPLayerHp: number;\n    public isPlayerDead: boolean = false;\n    public isDash: boolean = false;\n    public isCanPressDash: boolean = true;\n\n    public dame: number = 1;\n    public isMoving: boolean;\n    public isPlayAnimIdle: boolean = true;\n    public isPlayAnimMove: boolean = true;\n\n    public isStop: boolean = false;\n\n    public moveArr1: number[] = [];\n    public moveArr2: number[] = [];\n\n    public get AnimPlayerArr(): AnimationClip[] {\n        return this.animPlayerArr\n    }\n\n    public set AnimPlayerArr(animPlayerArr: AnimationClip[]) {\n        this.animPlayerArr = animPlayerArr;\n    }\n\n    protected start(): void {\n        this.onKeyboard();\n        this.playIdleMove();\n    }\n\n    protected update(dt: number): void {\n        this.cameraFollow();\n        this.playAnimDead();\n        if ((this.rigidPlayer.linearVelocity.x != 0 && this.isPlayAnimMove) || (this.rigidPlayer.linearVelocity.y != 0 && this.isPlayAnimMove) && !this.isDash) {\n            this.isMoving = true;\n            this.isPlayAnimMove = false;\n            this.playAnimMove();\n        }\n        else if (this.rigidPlayer.linearVelocity.x === 0 && this.rigidPlayer.linearVelocity.y === 0 && this.isPlayAnimIdle && !this.isDash) {\n            this.isPlayAnimIdle = false;\n            this.isMoving = false;\n            this.isPlayAnimMove = true;\n            this.playIdleMove();\n        }\n\n        if (this.moveArr1[this.moveArr1.length - 1] === 0 && !this.isDash && !this.isStop) {\n            this.rigidPlayer.linearVelocity = new Vec2(-7.5, this.rigidPlayer.linearVelocity.y);\n        }\n\n        if (this.moveArr1[this.moveArr1.length - 1] === 1 && !this.isDash && !this.isStop) {\n            this.rigidPlayer.linearVelocity = new Vec2(7.5, this.rigidPlayer.linearVelocity.y);\n        }\n\n        if (this.moveArr2[this.moveArr2.length - 1] === 0 && !this.isDash && !this.isStop) {\n            this.rigidPlayer.linearVelocity = new Vec2(this.rigidPlayer.linearVelocity.x, 7.5);\n        }\n        if (this.moveArr2[this.moveArr2.length - 1] === 1 && !this.isDash && !this.isStop) {\n            this.rigidPlayer.linearVelocity = new Vec2(this.rigidPlayer.linearVelocity.x, -7.5);\n        }\n\n        if (this.moveArr1.length === 0 && this.moveArr2.length === 0 && sys.isMobile && this.isDash) {\n            console.log('1')\n            this.rigidPlayer.linearVelocity = new Vec2(0, 0);\n        }\n    }\n\n    public onKeyDown(event?: EventKeyboard): void {\n        let index = 0;\n        switch (event.keyCode) {\n            case KeyCode.KEY_W:\n                index = this.moveArr2.findIndex((item) => item === 0);\n                if (index === -1) this.moveArr2.push(0);\n                break;\n            case KeyCode.ARROW_UP:\n                index = this.moveArr2.findIndex((item) => item === 0);\n                if (index === -1) this.moveArr2.push(0);\n                break;\n            case KeyCode.KEY_A:\n                index = this.moveArr1.findIndex((item) => item === 0);\n                if (index === -1) this.moveArr1.push(0);\n                break;\n            case KeyCode.ARROW_LEFT:\n                index = this.moveArr1.findIndex((item) => item === 0);\n                if (index === -1) this.moveArr1.push(0);\n                break;\n            case KeyCode.KEY_S :\n                index = this.moveArr2.findIndex((item) => item === 1);\n                if (index === -1) this.moveArr2.push(1);\n                break;\n            case KeyCode.ARROW_DOWN:\n                index = this.moveArr2.findIndex((item) => item === 1);\n                if (index === -1) this.moveArr2.push(1);\n                break;\n            case KeyCode.KEY_D:\n                index = this.moveArr1.findIndex((item) => item === 1);\n                if (index === -1) this.moveArr1.push(1);\n                break;\n            case KeyCode.ARROW_RIGHT:\n                index = this.moveArr1.findIndex((item) => item === 1);\n                if (index === -1) this.moveArr1.push(1);\n                break;\n            case KeyCode.KEY_F:\n                this.playAnimDash();\n                break;\n            case KeyCode.SPACE:\n                this.playAnimShooting();\n                break;\n            default: break;\n        }\n    }\n\n    public onKeyUp(event?: EventKeyboard): void {\n        switch (event.keyCode) {\n            case KeyCode.KEY_W:\n                this.rigidPlayer.linearVelocity = new Vec2(this.rigidPlayer.linearVelocity.x, 0);\n                let index5 = this.moveArr2.findIndex((item) => item === 0);\n                this.moveArr2.splice(index5, 1);\n                break;\n            case KeyCode.ARROW_UP:\n                this.rigidPlayer.linearVelocity = new Vec2(this.rigidPlayer.linearVelocity.x, 0);\n                let index6 = this.moveArr2.findIndex((item) => item === 0);\n                this.moveArr2.splice(index6, 1);\n                break;\n            case KeyCode.KEY_A:\n                this.rigidPlayer.linearVelocity = new Vec2(0, this.rigidPlayer.linearVelocity.y);\n                let index1 = this.moveArr1.findIndex((item) => item === 0);\n                this.moveArr1.splice(index1, 1);\n                break;\n            case KeyCode.ARROW_LEFT:\n                this.rigidPlayer.linearVelocity = new Vec2(0, this.rigidPlayer.linearVelocity.y);\n                let index2 = this.moveArr1.findIndex((item) => item === 0);\n                this.moveArr1.splice(index2, 1);\n                break;\n            case KeyCode.KEY_S:\n                this.rigidPlayer.linearVelocity = new Vec2(this.rigidPlayer.linearVelocity.x, 0);\n                let index7 = this.moveArr2.findIndex((item) => item === 1);\n                this.moveArr2.splice(index7, 1);\n                break;\n            case KeyCode.ARROW_DOWN:\n                this.rigidPlayer.linearVelocity = new Vec2(this.rigidPlayer.linearVelocity.x, 0);\n                let index8 = this.moveArr2.findIndex((item) => item === 1);\n                this.moveArr2.splice(index8, 1);\n                break;\n            case KeyCode.KEY_D:\n                this.rigidPlayer.linearVelocity = new Vec2(0, this.rigidPlayer.linearVelocity.y);\n                let index3 = this.moveArr1.findIndex((item) => item === 1);\n                this.moveArr1.splice(index3, 1);\n                break;\n            case KeyCode.ARROW_RIGHT:\n                this.rigidPlayer.linearVelocity = new Vec2(0, this.rigidPlayer.linearVelocity.y);\n                let index4 = this.moveArr1.findIndex((item) => item === 1);\n                this.moveArr1.splice(index4, 1);\n                break;\n            case KeyCode.SPACE:\n                this.isPlayAnimIdle = true;\n                break;\n            default:\n                break;\n        }\n    }\n\n    public offKeyboard(): void {\n        input.off(Input.EventType.KEY_DOWN, this.onKeyDown, this);\n        input.off(Input.EventType.KEY_UP, this.onKeyUp, this);\n    }\n\n    public onKeyboard(): void {\n        input.on(Input.EventType.KEY_DOWN, this.onKeyDown, this);\n        input.on(Input.EventType.KEY_UP, this.onKeyUp, this);\n    }\n\n    public playAnimShooting(): void {\n        if (!this.isMoving) {\n            this.animPlayer.defaultClip = this.animPlayer.clips[0];\n            this.animPlayer.play();\n        }\n    }\n\n    private playAnimMove(): void {\n        this.isPlayAnimIdle = true;\n        this.animPlayer.defaultClip = this.animPlayer.clips[1];\n        this.animPlayer.play();\n    }\n\n    public playIdleMove(): void {\n        this.animPlayer.defaultClip = this.animPlayer.clips[2];\n        this.animPlayer.play();\n    }\n\n    public playAnimDash(): void {\n        if (this.isCanPressDash) {\n            this.isCanPressDash = false;\n            this.isPlayAnimIdle = false;\n            this.isPlayAnimMove = false;\n            this.isDash = true;\n            if (this.isDash) {\n                if (this.rigidPlayer.linearVelocity.x > 0) {\n                    this.rigidPlayer.linearVelocity = new Vec2(15, this.rigidPlayer.linearVelocity.y);\n                }\n                else if (this.rigidPlayer.linearVelocity.x < 0) {\n                    this.rigidPlayer.linearVelocity = new Vec2(-15, this.rigidPlayer.linearVelocity.y);\n                } else if (this.rigidPlayer.linearVelocity.x === 0) {\n                    if (this.node.scale.x === 1) {\n                        this.rigidPlayer.linearVelocity = new Vec2(15, this.rigidPlayer.linearVelocity.y);\n                    } else {\n                        this.rigidPlayer.linearVelocity = new Vec2(-15, this.rigidPlayer.linearVelocity.y);\n                    }\n                }\n                this.animPlayer.defaultClip = this.animPlayer.clips[3];\n                this.animPlayer.play();\n                input.off(Input.EventType.KEY_DOWN, this.onKeyDown, this);\n                // input.off(Input.EventType.KEY_UP, this.onKeyUp, this);\n                this.scheduleOnce(function () {\n                    this.rigidPlayer.linearVelocity = new Vec2(0, this.rigidPlayer.linearVelocity.y);\n                    this.playIdleMove();\n                    input.on(Input.EventType.KEY_DOWN, this.onKeyDown, this);\n                    this.isPlayAnimIdle = true;\n                    this.isPlayAnimMove = true;\n                    this.isDash = false;\n                    // input.on(Input.EventType.KEY_UP, this.onKeyUp, this);\n                }, 0.5)\n                this.scheduleOnce(function(){\n                    this.isCanPressDash = true;\n                }, 5.025)\n            }\n\n        }\n    }\n\n    private cameraFollow(): void {\n        this.circleNode.position = new Vec3(this.node.position.x - 5, this.node.position.y - 25, this.circleNode.position.z);\n        this.pointNode.position = new Vec3(this.node.position.x - 5, this.node.position.y + 40, this.circleNode.position.z);\n        let targetPos = this.node.getPosition();\n        let cameraPos = this.cameraPlayer.node.getPosition();\n        if ((targetPos.x > -185 && Math.abs(this.node.position.x - this.redWall.position.x) >= 230) && targetPos.x <= 1470) {\n            let newPos = cameraPos.lerp(targetPos, 0.1);\n            this.cameraPlayer.node.setPosition(newPos.x, this.cameraPlayer.node.position.y, 1000);\n        }\n        if (targetPos.y < 100 && targetPos.y > -110) {\n            let newPos = cameraPos.lerp(targetPos, 0.1);\n            this.cameraPlayer.node.setPosition(this.cameraPlayer.node.position.x, newPos.y, 1000);\n        }\n    }\n\n    private playAnimDead(): void {\n        if (this.currentPLayerHp <= 0 && this.isPlayerDead === false) {\n            this.isPlayerDead = true;\n            input.off(Input.EventType.KEY_DOWN, this.onKeyDown, this);\n            input.off(Input.EventType.KEY_UP, this.onKeyUp, this);\n            this.animPlayer.defaultClip = this.animPlayer.clips[4];\n            this.animPlayer.play();\n            this.scheduleOnce(function () {\n                this.pointNode.active = false;\n                this.circleNode.active = false;\n                this.node.active = false;\n            }, 1)\n        }\n    }\n}\n\n\n"]}